<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-10-10 Sun 08:31 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Assignment05</title>
<meta name="author" content="Juan David Salcedo HernÃ¡ndez" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="src/readtheorg_theme/css/readtheorg.css"/>
<script type="text/javascript" src="src/lib/js/jquery.min.js"></script>
<script type="text/javascript" src="src/lib/js/bootstrap.min.js"></script>
<script type="text/javascript" src="src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="src/readtheorg_theme/js/readtheorg.js"></script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Assignment05</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org24f3bd0">1. Analytic derivative with Sympy</a></li>
<li><a href="#orga77b614">2. Activity</a></li>
</ul>
</div>
</div>
<p>
Usual display configurations and global imports:
</p>
<div class="org-src-container">
<pre class="src src-ipython">%config <span class="org-variable-name">InlineBackend.figure_format</span> = <span class="org-string">'svg'</span>

<span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np
<span class="org-keyword">import</span> sympy <span class="org-keyword">as</span> sp
<span class="org-keyword">import</span> scipy <span class="org-keyword">as</span> sc
<span class="org-comment-delimiter"># </span><span class="org-comment">from scipy import init_printing</span>
<span class="org-keyword">import</span> pandas <span class="org-keyword">as</span> pd
<span class="org-keyword">import</span> matplotlib.pyplot <span class="org-keyword">as</span> plt
<span class="org-keyword">from</span> tabulate <span class="org-keyword">import</span> tabulate
<span class="org-comment-delimiter"># </span><span class="org-comment">init_printing()</span>
</pre>
</div>

<div id="outline-container-org24f3bd0" class="outline-2">
<h2 id="org24f3bd0"><span class="section-number-2">1</span> Analytic derivative with Sympy</h2>
<div class="outline-text-2" id="text-1">
<p>
We first define a symbolic variable, which we call x; then we can construct a function with sympy&rsquo;s specific tools:
</p>
<div class="org-src-container">
<pre class="src src-ipython"><span class="org-variable-name">x</span> = sp.symbols(<span class="org-string">'x'</span>)
<span class="org-variable-name">f</span> = <span class="org-keyword">lambda</span> x : sp.sin(x**<span class="org-highlight-numbers-number">2</span>) + sp.log(x)
f(x)
</pre>
</div>

<pre class="example">
log(x) + sin(x**2)
</pre>
<p>
Therewith we can perform different symbolic operations, for instace, we can differentiate the function <code>f</code>:
</p>
<div class="org-src-container">
<pre class="src src-ipython"><span class="org-comment-delimiter"># </span><span class="org-comment">first derrivative with respect to the variable x</span>
<span class="org-variable-name">Df</span> = sp.diff( f(x), x, <span class="org-highlight-numbers-number">1</span> )
Df
</pre>
</div>

<pre class="example">
2*x*cos(x**2) + 1/x
</pre>
<p>
We cannot directly evaluate sympy-generated functions; we should lambdify them instead:
</p>
<div class="org-src-container">
<pre class="src src-ipython"><span class="org-variable-name">Df_</span> = sp.lambdify(x, Df, <span class="org-string">'numpy'</span>)

<span class="org-comment-delimiter"># </span><span class="org-comment">plot the graph of the function</span>
<span class="org-variable-name">x_</span> = np.linspace(<span class="org-highlight-numbers-number">0.1</span>, <span class="org-highlight-numbers-number">5</span>, <span class="org-highlight-numbers-number">100</span>)
plt.plot(x_, Df_(x_), <span class="org-string">'k-'</span>)
plt.show()
</pre>
</div>


<div id="orgfb14ec7" class="figure">
<p><object type="image/svg+xml" data="./obipy-resources/Aujsg6.svg" class="org-svg">
Sorry, your browser does not support SVG.</object>
</p>
</div>
</div>
</div>

<div id="outline-container-orga77b614" class="outline-2">
<h2 id="orga77b614"><span class="section-number-2">2</span> Activity</h2>
<div class="outline-text-2" id="text-2">
<p>
Handy sed command to manage pandas dataframes in emacs:
</p>
<div class="org-src-container">
<pre class="src src-sh" id="orgad408c7"><span class="org-type">echo</span> <span class="org-string">"</span><span class="org-string"><span class="org-constant">$</span></span><span class="org-string"><span class="org-variable-name">data</span></span><span class="org-string">"</span> | sed s/<span class="org-string">\^</span>:<span class="org-string">\ \/</span>/g | <span class="org-type">grep</span> -v <span class="org-string">"^$"</span> | sed s/<span class="org-string">\'</span>//g
</pre>
</div>

<p>
The following dataset comes from an experimental setup in which the period of a simple pendulum was measured for different deflection angles:
</p>
<div class="org-src-container">
<pre class="src src-ipython"><span class="org-variable-name">path</span> = <span class="org-string">"https://docs.google.com/spreadsheets/d/e/2PACX-1vT8btHZ-A6ChzV5Rx_CQmCzbhO10J7R6LvQAyHx9qOCoCDAL9RJgaGUATf2z5lTMo-SjByvrnaX02Cz/pub?output=csv"</span>
<span class="org-variable-name">df</span> = pd.read_csv(path, <span class="org-string">';'</span>)
tabulate(df.head(), headers=<span class="org-string">'keys'</span>, tablefmt=<span class="org-string">'orgtbl'</span>, showindex=<span class="org-string">'always'</span>)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">Tiempo (ms)</th>
<th scope="col" class="org-left">Ãngulo 1,</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">9</td>
<td class="org-left">59,289611816406</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">42</td>
<td class="org-left">59,9823265075684</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">75</td>
<td class="org-left">61,2374534606934</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">108</td>
<td class="org-left">63,49247741699</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">142</td>
<td class="org-left">65,3887710571289</td>
</tr>
</tbody>
</table>

<p>
To begin with, we ought to transform these datapoints into reasonable units (radians). On
the grounds that the angle series encompasses string values rather than
numerical ones, we must perform a type conversion and then a unit conversion to
obtain the desired result:
</p>
<div class="org-src-container">
<pre class="src src-ipython"><span class="org-variable-name">df</span> = df.rename( columns = {<span class="org-string">'Tiempo (ms)'</span>: <span class="org-string">'Tiempo[ms]'</span>, <span class="org-string">'&#193;ngulo 1,'</span>: <span class="org-string">'AnguloDeg'</span>} )

<span class="org-comment-delimiter"># </span><span class="org-comment">convert strings to float values</span>
<span class="org-variable-name">df</span>[<span class="org-string">'AnguloDeg'</span>] = df[<span class="org-string">'AnguloDeg'</span>].replace(<span class="org-string">'[,]'</span>, <span class="org-string">'.'</span>, regex=<span class="org-constant">True</span>).astype(<span class="org-builtin">float</span>)

<span class="org-comment-delimiter"># </span><span class="org-comment">add radians</span>
<span class="org-variable-name">df</span>[<span class="org-string">'AnguloRad'</span>] = df[<span class="org-string">'AnguloDeg'</span>].<span class="org-builtin">apply</span>( <span class="org-keyword">lambda</span> x : np.deg2rad(x) - <span class="org-highlight-numbers-number">0.5</span>*np.pi)

tabulate(df.head(), headers=<span class="org-string">'keys'</span>, tablefmt=<span class="org-string">'orgtbl'</span>, showindex=<span class="org-string">'always'</span>)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">Tiempo[ms]</th>
<th scope="col" class="org-right">AnguloDeg</th>
<th scope="col" class="org-right">AnguloRad</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">9</td>
<td class="org-right">59.2896</td>
<td class="org-right">-0.535997</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">42</td>
<td class="org-right">59.9823</td>
<td class="org-right">-0.523907</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">75</td>
<td class="org-right">61.2375</td>
<td class="org-right">-0.502001</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">108</td>
<td class="org-right">63.4925</td>
<td class="org-right">-0.462644</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">142</td>
<td class="org-right">65.3888</td>
<td class="org-right">-0.429547</td>
</tr>
</tbody>
</table>

<p>
Aiming for an insightful visualisation of this phenomenon, we can easily plot
these datapoints. We see that the pendulum&rsquo;s motion is, approximately, a damped
harmonic oscillator:
</p>
<div class="org-src-container">
<pre class="src src-ipython">plt.plot(df[<span class="org-string">'Tiempo[ms]'</span>], df.AnguloRad, <span class="org-string">'b.'</span>)
plt.xlim(<span class="org-highlight-numbers-number">0</span>, <span class="org-highlight-numbers-number">20000</span>)
plt.show()
</pre>
</div>


<div id="org8a4c878" class="figure">
<p><object type="image/svg+xml" data="./obipy-resources/Qknd0A.svg" class="org-svg">
Sorry, your browser does not support SVG.</object>
</p>
</div>

<p>
Now we would like to obtain the frequency at which the pendulum moves. We can
use the machinery of Fourier transforms to achieve this. The basic idea of a
Fourier transform is that we can decompose a function \(f\) describing the
amplitude of a wave over time into the (potentially many) harmonic functions of
<span class="underline">different frequencies</span> that comprise such a wave. To do this we define a
complex function \(\hat f\) over a (real) <span class="underline">frequency</span> domain such that its norm on
the complex plane has local maximum values (intuitively, peak values) whenever
the input frequency corresponds to the frequency of one of the harmonic
functions that make up the original function \(f\).
</p>

<p>
It turns out that this special complex-valued function \(\hat f : \mathbb{R} \to
\mathbb{C}\) is described by
\[ \hat f(k) = \int_{-\infty}^{\infty} f(t) \exp(-2\pi i k t )\,dt; \]
this integration is performed with respect to a time domain \(t\), and \(k\)
represents the input frequency of \(\hat f\). This \(\hat f\) function is the
Fourier transform of \(f\).
</p>

<p>
For discrete values, though, we cannot hope to compute an integral, let alone an
improper integral; instead we take the summation approach: If \(\{a_n\}_{n=0}^m\) are the
observed amplitude values on an <span class="underline">evenly partitioned time domain</span>, then we have
\[ \hat f(k) = \sum_{n=0}^m a_n \exp\left( -2\pi ik \frac{n}{m} \right). \]
</p>

<p>
This definition is precisely the one that is implemented in scipy:
</p>
<div class="org-src-container">
<pre class="src src-ipython"><span class="org-keyword">from</span> scipy.fft <span class="org-keyword">import</span> fft, fftfreq
<span class="org-doc">''' Fourier transform module '''</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">time step</span>
<span class="org-variable-name">t_step</span> = 33E-<span class="org-highlight-numbers-number">3</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">highest summation index</span>
<span class="org-variable-name">m</span> = <span class="org-builtin">len</span>( df[<span class="org-string">'Tiempo[ms]'</span>] )

<span class="org-comment-delimiter"># </span><span class="org-comment">Fourier transform for angle values, defined as an array,</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">f hat computed at approptiate frequencies</span>
<span class="org-variable-name">ft</span> = fft(df[<span class="org-string">'AnguloRad'</span>].values)[:m//<span class="org-highlight-numbers-number">2</span>]

<span class="org-comment-delimiter"># </span><span class="org-comment">frequencies corresponding to the Fourier transform</span>
<span class="org-variable-name">frequencies</span> = fftfreq(m, t_step)[:m//<span class="org-highlight-numbers-number">2</span>]

<span class="org-comment-delimiter"># </span><span class="org-comment">Graph of the Fourier transform</span>
plt.plot(frequencies, np.<span class="org-builtin">abs</span>(ft), <span class="org-string">'bo'</span>)
plt.ylabel(<span class="org-string">"Fourier tranform value"</span>)
plt.xlabel(<span class="org-string">"Frequency"</span>)
plt.xlim(<span class="org-highlight-numbers-number">0.6</span>, <span class="org-highlight-numbers-number">0.75</span>)
plt.grid()
plt.show()
</pre>
</div>


<div id="org85370ca" class="figure">
<p><object type="image/svg+xml" data="./obipy-resources/J7x3qU.svg" class="org-svg">
Sorry, your browser does not support SVG.</object>
</p>
</div>

<p>
We may then interpolate these datapoints with cubic splines as follows:
</p>
<div class="org-src-container">
<pre class="src src-ipython"><span class="org-keyword">from</span> scipy.interpolate <span class="org-keyword">import</span> CubicSpline

<span class="org-comment-delimiter"># </span><span class="org-comment">domain and range of Fourier transform</span>
<span class="org-variable-name">dom</span>, <span class="org-variable-name">ran</span> = frequencies, np.<span class="org-builtin">abs</span>(ft)

<span class="org-comment-delimiter"># </span><span class="org-comment">apply the cubic splines method</span>
<span class="org-variable-name">cubic_sp</span> = CubicSpline(dom, ran)

<span class="org-comment-delimiter"># </span><span class="org-comment">derivative of the interpolating spline</span>
<span class="org-variable-name">Dcubic</span> = cubic_sp.derivative()

<span class="org-comment-delimiter"># </span><span class="org-comment">visualise interpolation</span>
<span class="org-variable-name">xs</span> = np.linspace(<span class="org-highlight-numbers-number">0.6</span>, <span class="org-highlight-numbers-number">0.75</span>, <span class="org-highlight-numbers-number">1000</span>)

plt.plot(dom, ran, <span class="org-string">'bo'</span>)
plt.plot(xs, cubic_sp(xs), <span class="org-string">'k-'</span>)
<span class="org-comment-delimiter"># </span><span class="org-comment">plt.plot(xs, Dcubic(xs), 'k-')</span>
plt.ylabel(<span class="org-string">"TF"</span>)
plt.xlabel(<span class="org-string">"Frecuencia"</span>)
plt.xlim(<span class="org-highlight-numbers-number">0.6</span>, <span class="org-highlight-numbers-number">0.75</span>)
plt.grid()
plt.show()
</pre>
</div>


<div id="orge5e86fc" class="figure">
<p><object type="image/svg+xml" data="./obipy-resources/PMFNI3.svg" class="org-svg">
Sorry, your browser does not support SVG.</object>
</p>
</div>

<p>
Now we find a root for the derivative of the interpolation, which gives us the
critical value that we want (the maximum).
</p>
<div class="org-src-container">
<pre class="src src-ipython"><span class="org-keyword">from</span> scipy <span class="org-keyword">import</span> optimize

<span class="org-comment-delimiter"># </span><span class="org-comment">find the value in which the drivative is 0</span>
<span class="org-variable-name">root</span> = optimize.bisect(Dcubic, <span class="org-highlight-numbers-number">0.66</span>, <span class="org-highlight-numbers-number">0.68</span>)

<span class="org-comment-delimiter"># </span><span class="org-comment">print the maximum point if the derivative evaluated at it</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">is sufficiently close to 0</span>
<span class="org-variable-name">tol</span> = 1e-<span class="org-highlight-numbers-number">5</span>
<span class="org-keyword">if</span> <span class="org-builtin">abs</span>( Dcubic(root) ) &lt; tol :
    <span class="org-keyword">print</span>(root)
<span class="org-keyword">else</span> :
    <span class="org-keyword">print</span>(<span class="org-string">'failed'</span>)
</pre>
</div>

<pre class="example">
0.6715600030391943
</pre>


<p>
Thus we can conclude that the frequency at which our pendulum oscillates is approximately \(0.6715\,kHz\).
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Juan David Salcedo HernÃ¡ndez</p>
<p class="date">Created: 2021-10-10 Sun 08:31</p>
<p class="creator"><a href="https://www.gnu.org/software/emacs/">Emacs</a> 27.1 (<a href="https://orgmode.org">Org</a> mode 9.5)</p>
</div>
</body>
</html>
