<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-09-29 Wed 15:37 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Review3</title>
<meta name="author" content="Juan David Salcedo Hernández" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="src/readtheorg_theme/css/readtheorg.css"/>
<script type="text/javascript" src="src/lib/js/jquery.min.js"></script>
<script type="text/javascript" src="src/lib/js/bootstrap.min.js"></script>
<script type="text/javascript" src="src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="src/readtheorg_theme/js/readtheorg.js"></script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">Review3</h1>
<div class="org-src-container">
<pre class="src src-ipython">%config InlineBackend.figure_format = <span style="color: #f1fa8c;">'svg'</span>

<span style="color: #ff79c6;">import</span> numpy <span style="color: #ff79c6;">as</span> np
<span style="color: #ff79c6;">import</span> pandas <span style="color: #ff79c6;">as</span> pd
<span style="color: #ff79c6;">import</span> matplotlib.pyplot <span style="color: #ff79c6;">as</span> plt
<span style="color: #ff79c6;">from</span> tabulate <span style="color: #ff79c6;">import</span> tabulate
<span style="color: #ff79c6;">import</span> scipy.interpolate <span style="color: #ff79c6;">as</span> interpolate
<span style="color: #ff79c6;">import</span> scipy.optimize <span style="color: #ff79c6;">as</span> optimize
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh" id="org429fdd2"><span style="color: #bd93f9;">echo</span> <span style="color: #f1fa8c;">"</span><span style="color: #8be9fd;">$</span><span style="color: #f1fa8c;">data</span><span style="color: #f1fa8c;">"</span> | sed s/<span style="color: #f1fa8c;">\^</span>:<span style="color: #f1fa8c;">\ \/</span>/g | <span style="color: #bd93f9;">grep</span> -v <span style="color: #f1fa8c;">"^$"</span> | sed s/<span style="color: #f1fa8c;">\'</span>//g
</pre>
</div>

<p>
A particle of mass 0.2 kg moves for 0.4 s according to the physical trajectory described by the data over in the following dataframe:
</p>
<div class="org-src-container">
<pre class="src src-ipython">path = <span style="color: #f1fa8c;">'https://raw.githubusercontent.com/restrepo/ComputationalMethods/master/data/mvto.csv'</span>
df = pd.read_csv(path)
<span style="color: #6272a4;"># </span><span style="color: #6272a4;">add error column</span>
df[<span style="color: #f1fa8c;">'xerror'</span>] = [1e-<span style="color: #bd93f9; font-weight: bold;">08</span>]*df.shape[<span style="color: #bd93f9; font-weight: bold;">0</span>]

tabulate(df.head(), headers=<span style="color: #f1fa8c;">'keys'</span>, tablefmt=<span style="color: #f1fa8c;">'orgtbl'</span>, showindex=<span style="color: #f1fa8c;">'always'</span>)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">t</th>
<th scope="col" class="org-right">x</th>
<th scope="col" class="org-right">xerror</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">-0</td>
<td class="org-right">1e-08</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">0.0444444</td>
<td class="org-right">0.0670359</td>
<td class="org-right">1e-08</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">0.0888889</td>
<td class="org-right">0.125986</td>
<td class="org-right">1e-08</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">0.133333</td>
<td class="org-right">0.169741</td>
<td class="org-right">1e-08</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">0.177778</td>
<td class="org-right">0.193022</td>
<td class="org-right">1e-08</td>
</tr>
</tbody>
</table>

<p>
We shall check whether the particle is moving in free fall or simple harmonic
motion. To do this we may fit the data to both models, and decide by means of
the absolute error in each datapoint.
</p>
<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #ff79c6;">def</span> <span style="color: #50fa7b;">compare_models</span>(functions, _t, _x, _xerror=<span style="color: #8be9fd;">None</span>):
    <span style="color: #ff79c6;">if</span> _xerror <span style="color: #ff79c6;">is</span> <span style="color: #8be9fd;">None</span>:
        _xerror = _x.shape[<span style="color: #bd93f9; font-weight: bold;">0</span>]

    func_names = np.empty(<span style="color: #ffb86c;">len</span>(functions), dtype=<span style="color: #f1fa8c;">'S10'</span>)
    predictions = np.zeros([<span style="color: #ffb86c;">len</span>(functions), <span style="color: #ffb86c;">len</span>(_t)])
    i = <span style="color: #bd93f9; font-weight: bold;">0</span>
    <span style="color: #ff79c6;">for</span> function <span style="color: #ff79c6;">in</span> functions:
        <span style="color: #6272a4;"># </span><span style="color: #6272a4;">populate the array of function tags</span>
        func_names[i] = function.<span style="color: #ffb86c;">__name__</span>
        <span style="color: #6272a4;"># </span><span style="color: #6272a4;">perform the optimisation process and populate the</span>
        <span style="color: #6272a4;"># </span><span style="color: #6272a4;">array of predictions</span>
        popt, pcov = optimize.curve_fit(function, _t, _x, sigma=_xerror)
        predictions[i,:] = function(_t, *popt)
        i += <span style="color: #bd93f9; font-weight: bold;">1</span>

    <span style="color: #6272a4;"># </span><span style="color: #6272a4;">redefine the array of actual x values with the same shape</span>
    <span style="color: #6272a4;"># </span><span style="color: #6272a4;">as the array of predictions</span>
    x_array = np.array([_x])
    x_array = np.repeat(x_array, repeats=predictions.shape[<span style="color: #bd93f9; font-weight: bold;">0</span>], axis=<span style="color: #bd93f9; font-weight: bold;">0</span>)
    <span style="color: #6272a4;"># </span><span style="color: #6272a4;">compute absolute errors</span>
    abs_err = np.<span style="color: #ffb86c;">abs</span>(x_array - predictions).<span style="color: #ffb86c;">sum</span>(axis=<span style="color: #bd93f9; font-weight: bold;">1</span>)

    <span style="color: #ff79c6;">return</span> {A: B <span style="color: #ff79c6;">for</span> A, B <span style="color: #ff79c6;">in</span> <span style="color: #ffb86c;">zip</span>(func_names, abs_err)}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #6272a4;"># </span><span style="color: #6272a4;">define our datapoints</span>
_t = df[<span style="color: #f1fa8c;">'t'</span>]
_x = df[<span style="color: #f1fa8c;">'x'</span>]
_xerror = df[<span style="color: #f1fa8c;">'xerror'</span>]
<span style="color: #6272a4;"># </span><span style="color: #6272a4;">define our model functions</span>
<span style="color: #ff79c6;">def</span> <span style="color: #50fa7b;">_harmonic</span>(t, A, ang_freq):
    <span style="color: #6272a4;"># </span><span style="color: #6272a4;">the simple harmonic motion equation is: x = A*sin(ang_freq*t)</span>
    <span style="color: #ff79c6;">return</span> A*np.sin(ang_freq*t)
<span style="color: #ff79c6;">def</span> <span style="color: #50fa7b;">_free_fall</span>(t, x_ini, v_ini, g=<span style="color: #bd93f9; font-weight: bold;">9.8</span>):
    <span style="color: #ff79c6;">return</span> x_ini + v_ini*t - <span style="color: #bd93f9; font-weight: bold;">0.5</span>*g*t**<span style="color: #bd93f9; font-weight: bold;">2</span>

functions = [_harmonic, _free_fall]

compare_models(functions, _t, _x, _xerror=_xerror)
</pre>
</div>

<pre class="example">
{b'_harmonic': 6.154342270279314e-08, b'_free_fall': 0.04000247638415919}
</pre>
</div>
<div id="postamble" class="status">
<p class="author">Author: Juan David Salcedo Hernández</p>
<p class="date">Created: 2021-09-29 Wed 15:37</p>
<p class="creator"><a href="https://www.gnu.org/software/emacs/">Emacs</a> 27.1 (<a href="https://orgmode.org">Org</a> mode 9.5)</p>
</div>
</body>
</html>
